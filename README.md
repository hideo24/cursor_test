# 仕事レポーティング自動化システム（GAS）

毎日午前9時に自動実行され、スプレッドシートのタスクデータを分析して詳細なレポートを生成するGoogle Apps Scriptシステムです。

## 📋 機能概要

### 🔄 自動レポート生成
- **毎日午前9時**に自動実行
- スプレッドシートからタスクデータを取得
- 包括的な分析とレポート生成
- メール通知とスプレッドシート出力

### 📊 分析内容
- **全体サマリー**: 総タスク数、完了率、ステータス別集計
- **要注意事項**: 期限切れ、本日期限、今後3日以内のタスク
- **優先度分析**: 高・中・低優先度タスクの状況
- **担当者別分析**: 個人別の完了率と作業状況
- **TODO事項**: 自動生成された改善提案

### 📧 通知機能
- レポートの自動メール送信
- エラー発生時の通知
- スプレッドシートへの履歴保存

## 🚀 セットアップ手順

### 1. ファイルの準備
```bash
# 必要なファイル
├── Code.gs              # メインプログラム
├── SheetTemplate.gs     # スプレッドシートテンプレート
└── appsscript.json     # プロジェクト設定
```

### 2. Google Apps Scriptプロジェクトの作成
1. [Google Apps Script](https://script.google.com/)にアクセス
2. 「新しいプロジェクト」を作成
3. 上記3つのファイルの内容をコピー・ペースト

### 3. スプレッドシートテンプレートの作成
```javascript
// GASエディタで以下を実行
createSpreadsheetTemplate();
```

### 4. 設定の更新
```javascript
// Code.gsの設定を更新
const CONFIG = {
  SPREADSHEET_ID: 'YOUR_SPREADSHEET_ID_HERE',     // ←作成したスプレッドシートID
  NOTIFICATION_EMAIL: 'your-email@example.com',   // ←通知先メールアドレス
  // その他の設定...
};
```

### 5. 権限の承認
1. 初回実行時に権限承認が必要
2. スプレッドシート、メール送信権限を許可

### 6. 自動実行トリガーの設定
```javascript
// 毎日午前9時の実行トリガーを設定
setupDailyTrigger();
```

### 7. テスト実行
```javascript
// 動作確認
testReport();
```

## 📋 スプレッドシートのデータ形式

### データシートの列構成
| 列 | 項目 | 形式 | 説明 |
|---|---|---|---|
| A | 日付 | yyyy/mm/dd | タスクの登録日 |
| B | タスク名 | テキスト | 作業内容の説明 |
| C | ステータス | 選択肢 | 未着手/進行中/完了/保留/キャンセル |
| D | 優先度 | 選択肢 | 高/中/低 |
| E | 担当者 | テキスト | 責任者の名前 |
| F | 期限 | yyyy/mm/dd | 完了予定日 |
| G | 備考 | テキスト | 追加情報 |

### 入力例
```
日付      | タスク名           | ステータス | 優先度 | 担当者 | 期限      | 備考
2024/01/15| プロジェクト企画書作成 | 進行中    | 高     | 田中   | 2024/01/20| 来週までに完成予定
2024/01/14| クライアント打ち合わせ | 完了      | 高     | 佐藤   | 2024/01/14| 
```

## 📈 生成されるレポート例

```
=================================
📊 日次レポート - 2024年01月16日
=================================

【📈 全体サマリー】
・総タスク数: 25
・完了タスク: 18
・進行中タスク: 5
・未着手タスク: 2
・完了率: 72%

【🚨 要注意事項】

⚠️ 期限切れタスク (2件):
  • システム設計書レビュー (担当: 鈴木, 期限: 01/14)
  • バグ修正 (担当: 山田, 期限: 01/15)

📅 本日期限のタスク (3件):
  • テストケース作成 (担当: 田中, ステータス: 進行中)
  • 資料準備 (担当: 佐藤, ステータス: 完了)

【👥 担当者別状況】
• 田中: 完了率 80% (8/10) - 進行中: 2, 未着手: 0
• 佐藤: 完了率 90% (9/10) - 進行中: 1, 未着手: 0
• 鈴木: 完了率 60% (3/5) - 進行中: 1, 未着手: 1

【📝 TODO事項】
• 期限切れタスク 2件の対応が必要
• 本日期限のタスク 3件の進捗確認
=================================
```

## 🔧 カスタマイズ

### 分析項目の追加
`analyzeData()`関数を修正して、新しい分析項目を追加できます。

### レポート形式の変更
`generateReport()`関数でレポートの形式をカスタマイズできます。

### 通知方法の変更
- Slack通知の追加
- チャットワーク連携
- Webhookによる外部システム連携

### 実行頻度の変更
```javascript
// 週次実行の場合
ScriptApp.newTrigger('main')
  .timeBased()
  .everyWeeks(1)
  .onWeekDay(ScriptApp.WeekDay.MONDAY)
  .atHour(9)
  .create();
```

## 🔒 セキュリティ

### 権限設定
- スプレッドシート読み書き権限
- メール送信権限
- トリガー設定権限

### データ保護
- 機密情報の取り扱い注意
- 適切なアクセス権限設定
- 定期的な設定見直し

## 🐛 トラブルシューティング

### よくある問題

**1. 権限エラー**
```
解決方法: スクリプトの権限を再承認してください
```

**2. スプレッドシートが見つからない**
```
解決方法: CONFIG.SPREADSHEET_IDが正しく設定されているか確認
```

**3. メール通知が届かない**
```
解決方法: 
- メールアドレスの設定確認
- スパムフォルダーの確認
- Gmailの送信制限確認
```

**4. トリガーが動作しない**
```
解決方法:
- トリガーの設定確認
- スクリプトの実行ログ確認
- 権限の再承認
```

## 📞 サポート

### ログの確認
```javascript
// 実行ログの確認
console.log('デバッグ情報');
```

### エラーハンドリング
システムにはエラー通知機能が組み込まれており、問題発生時に自動でメール通知されます。

## 🔄 更新履歴

### v1.0.0 (2024/01/16)
- 初回リリース
- 基本的なレポート生成機能
- 自動実行トリガー
- メール通知機能

---

**注意**: このシステムを使用する前に、必ず設定ファイルを適切に更新し、テスト実行を行ってください。
